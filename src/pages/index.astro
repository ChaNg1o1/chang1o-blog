---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 6);
---

<!doctype html>
<html lang="zh-CN">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body class="min-h-screen flex flex-col bg-white dark:bg-black text-black dark:text-white">
		<Header />
		<main class="flex-1 max-w-5xl mx-auto px-5 py-16 w-full">
			<!-- Hero Section -->
			<section class="mb-20">
				<div class="border-l-4 border-black dark:border-white pl-6 mb-8">
					<h1 class="text-4xl font-bold tracking-tight mb-2">
						{SITE_TITLE}
					</h1>
					<p class="text-neutral-600 dark:text-neutral-400 text-lg">{SITE_DESCRIPTION}</p>
				</div>
				<div class="flex flex-wrap gap-4">
					<a
						href={`${import.meta.env.BASE_URL.replace(/\/$/, '')}/blog`}
						class="inline-flex items-center px-5 py-2.5 bg-black dark:bg-white text-white dark:text-black font-medium text-sm hover:bg-neutral-800 dark:hover:bg-neutral-200 transition-colors"
					>
						阅读文章
					</a>
					<a
						href={`${import.meta.env.BASE_URL.replace(/\/$/, '')}/about`}
						class="inline-flex items-center px-5 py-2.5 border-2 border-black dark:border-white text-black dark:text-white font-medium text-sm hover:bg-black hover:text-white dark:hover:bg-white dark:hover:text-black transition-colors"
					>
						关于我
					</a>
				</div>
			</section>

			<!-- Divider -->
			<hr class="border-neutral-200 dark:border-neutral-800 mb-16" />

			<!-- Recent Posts -->
			<section>
				<h2 class="text-xl font-bold mb-8 pb-2 border-b border-neutral-200 dark:border-neutral-800 flex items-center">
					<span class="bg-black dark:bg-white text-white dark:text-black px-2 py-0.5 text-sm mr-3">01</span>
					最新文章
				</h2>
				<ul class="grid gap-5">
					{
						posts.map((post) => (
							<li class="border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-black hover:border-black dark:hover:border-white transition-colors">
								<a href={`${import.meta.env.BASE_URL.replace(/\/$/, '')}/blog/${post.id}/`} class="block p-6">
									<div class="flex flex-col sm:flex-row sm:items-start gap-4">
										<div class="flex-shrink-0 text-center border border-neutral-200 dark:border-neutral-800 p-3 min-w-[80px]">
											<div class="text-2xl font-bold text-black dark:text-white">
												{post.data.pubDate.getDate()}
											</div>
											<div class="text-xs text-neutral-500 dark:text-neutral-400 uppercase tracking-wider">
												{post.data.pubDate.toLocaleDateString('zh-CN', { month: 'short' })}
											</div>
										</div>
										<div class="flex-1">
											<h3 class="text-lg font-semibold text-black dark:text-white mb-2 hover:text-neutral-600 dark:hover:text-neutral-300 transition-colors">
												{post.data.title}
											</h3>
											<p class="text-neutral-600 dark:text-neutral-400 mb-3 text-sm leading-relaxed">
												{post.data.description}
											</p>
											<div class="flex flex-wrap items-center gap-3 text-xs text-neutral-500 dark:text-neutral-400">
												<span>
													{post.data.pubDate.toLocaleDateString('zh-CN', {
														year: 'numeric',
														month: 'short',
														day: 'numeric',
													})}
												</span>
												{post.data.tags && (
													<span class="w-px h-3 bg-neutral-300 dark:bg-neutral-700"></span>
													<div class="flex gap-2">
														{post.data.tags.slice(0, 3).map((tag) => (
															<span class="px-2 py-0.5 bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300 text-xs">
																{tag}
															</span>
														))}
													</div>
												)}
											</div>
										</div>
									</div>
								</a>
							</li>
						))
					}
				</ul>

				{posts.length === 0 && (
					<p class="text-center text-neutral-500 dark:text-neutral-400 py-12 border border-dashed border-neutral-300 dark:border-neutral-700">
						暂无文章
					</p>
				)}
			</section>
		</main>
		<Footer />
	</body>
</html>
